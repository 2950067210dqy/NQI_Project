2025-09-14 22:23:05 | INFO     | __main__:__init__:105 | 高级任务管理器初始化完成
2025-09-14 22:23:05 | INFO     | __main__:_run_scheduler:723 | 调度器线程已启动
2025-09-14 22:23:05 | SUCCESS  | __main__:start:719 | 高级任务管理器已启动
2025-09-14 22:23:05 | ERROR    | __main__:_run_scheduler:730 | 调度器运行出错
2025-09-14 22:23:05 | ERROR    | __main__:add_task:450 | 添加任务失败
2025-09-14 22:23:05 | ERROR    | __main__:<module>:901 | 程序运行出错
2025-09-14 22:23:05 | INFO     | __main__:shutdown:741 | 开始关闭高级任务管理器...
2025-09-14 22:23:05 | DEBUG    | __main__:shutdown:747 | 等待调度器线程结束...
2025-09-14 22:23:10 | INFO     | __main__:_run_scheduler:733 | 调度器线程已停止
2025-09-14 22:23:10 | DEBUG    | __main__:shutdown:750 | 关闭线程池...
2025-09-14 22:23:14 | INFO     | __main__:__init__:105 | 高级任务管理器初始化完成
2025-09-14 22:23:14 | INFO     | __main__:_run_scheduler:723 | 调度器线程已启动
2025-09-14 22:23:14 | SUCCESS  | __main__:start:719 | 高级任务管理器已启动
2025-09-14 22:23:14 | ERROR    | __main__:_run_scheduler:730 | 调度器运行出错
2025-09-14 22:23:14 | ERROR    | __main__:add_task:450 | 添加任务失败
2025-09-14 22:23:14 | ERROR    | __main__:<module>:901 | 程序运行出错
2025-09-14 22:23:14 | INFO     | __main__:shutdown:741 | 开始关闭高级任务管理器...
2025-09-14 22:23:14 | DEBUG    | __main__:shutdown:747 | 等待调度器线程结束...
2025-09-14 22:23:19 | INFO     | __main__:_run_scheduler:733 | 调度器线程已停止
2025-09-14 22:23:19 | DEBUG    | __main__:shutdown:750 | 关闭线程池...
2025-09-14 22:24:42 | INFO     | __main__:__init__:105 | 高级任务管理器初始化完成
2025-09-14 22:24:42 | INFO     | __main__:_run_scheduler:723 | 调度器线程已启动
2025-09-14 22:24:42 | SUCCESS  | __main__:start:719 | 高级任务管理器已启动
2025-09-14 22:24:42 | INFO     | __main__:add_task:477 | 普通任务已添加
2025-09-14 22:24:42 | INFO     | __main__:add_scheduled_to_interval_task:277 | 动态调度任务已添加
2025-09-14 22:24:42 | INFO     | __main__:add_task:477 | 普通任务已添加
2025-09-14 22:24:42 | INFO     | __main__:<module>:862 | 任务管理器运行中，按 Ctrl+C 退出...
2025-09-14 22:24:42 | INFO     | __main__:<module>:863 | 动态任务将在 22:26 开始执行
2025-09-14 22:24:42 | INFO     | __main__:<module>:872 | 系统状态: {
  "is_running": true,
  "total_tasks": 3,
  "dynamic_tasks": 1,
  "normal_tasks": 2,
  "max_workers": 3,
  "scheduler_thread_alive": true,
  "pending_jobs": 3,
  "shutdown_requested": false
}
2025-09-14 22:24:42 | INFO     | __main__:<module>:873 | 任务统计: {
  "total_tasks": 3,
  "tasks_by_type": {
    "normal": 2,
    "dynamic_scheduled_to_interval": 1
  },
  "tasks_by_status": {
    "waiting": 3
  },
  "tasks_by_unit": {
    "seconds": 2,
    "unknown": 1
  },
  "oldest_task": {
    "id": "task_1",
    "name": "普通周期任务",
    "created_at": "2025-09-14T22:24:42.698720"
  },
  "newest_task": {
    "id": "task_3",
    "name": "错误测试任务",
    "created_at": "2025-09-14T22:24:42.698720"
  },
  "total_executions": 0
}
2025-09-14 22:24:42 | INFO     | __main__:<module>:894 | 定时转间隔任务状态: {
  "task_id": "task_1",
  "name": "普通周期任务",
  "execution_count": 0,
  "converted_to_interval": false,
  "end_time": null
}
2025-09-14 22:25:02 | INFO     | __main__:<module>:885 | 动态任务状态: {
  "task_id": "dynamic_task_2",
  "name": "动态数据处理任务",
  "status": "waiting",
  "execution_count": 0,
  "start_time": null
}
2025-09-14 22:25:12 | INFO     | __main__:wrapped_task:393 | 开始执行任务
2025-09-14 22:25:12 | INFO     | __main__:sample_task:783 | 执行示例任务测试|5
2025-09-14 22:25:14 | SUCCESS  | __main__:wrapped_task:404 | 任务执行完成
2025-09-14 22:25:14 | INFO     | __main__:_convert_to_interval:534 | 任务已转换为间隔调度，将在指定时间后自动移除
2025-09-14 22:25:24 | INFO     | __main__:wrapped_task:393 | 开始执行任务
2025-09-14 22:25:24 | INFO     | __main__:sample_task:783 | 执行示例任务测试|5
2025-09-14 22:25:26 | SUCCESS  | __main__:wrapped_task:404 | 任务执行完成
2025-09-14 22:25:27 | INFO     | __main__:wrapped_task:393 | 开始执行任务
2025-09-14 22:25:27 | INFO     | __main__:error_task:796 | 执行会出错的任务
2025-09-14 22:25:27 | ERROR    | __main__:wrapped_task:431 | 任务执行失败
2025-09-14 22:25:36 | INFO     | __main__:wrapped_task:393 | 开始执行任务
2025-09-14 22:25:36 | INFO     | __main__:sample_task:783 | 执行示例任务测试|5
2025-09-14 22:25:38 | SUCCESS  | __main__:wrapped_task:404 | 任务执行完成
2025-09-14 22:25:48 | INFO     | __main__:wrapped_task:393 | 开始执行任务
2025-09-14 22:25:48 | INFO     | __main__:sample_task:783 | 执行示例任务测试|5
2025-09-14 22:25:50 | SUCCESS  | __main__:wrapped_task:404 | 任务执行完成
2025-09-14 22:26:00 | INFO     | __main__:dynamic_task_wrapper:205 | 执行动态任务
2025-09-14 22:26:00 | INFO     | __main__:data_processing_task:790 | 开始数据处理
2025-09-14 22:26:02 | INFO     | __main__:<module>:872 | 系统状态: {
  "is_running": true,
  "total_tasks": 3,
  "dynamic_tasks": 1,
  "normal_tasks": 2,
  "max_workers": 3,
  "scheduler_thread_alive": true,
  "pending_jobs": 3,
  "shutdown_requested": false
}
2025-09-14 22:26:02 | INFO     | __main__:<module>:873 | 任务统计: {
  "total_tasks": 3,
  "tasks_by_type": {
    "normal": 2,
    "dynamic_scheduled_to_interval": 1
  },
  "tasks_by_status": {
    "running": 3
  },
  "tasks_by_unit": {
    "seconds": 2,
    "unknown": 1
  },
  "oldest_task": {
    "id": "task_1",
    "name": "普通周期任务",
    "created_at": "2025-09-14T22:24:42.698720"
  },
  "newest_task": {
    "id": "task_3",
    "name": "错误测试任务",
    "created_at": "2025-09-14T22:24:42.698720"
  },
  "total_executions": 6
}
2025-09-14 22:26:02 | INFO     | __main__:<module>:894 | 定时转间隔任务状态: {
  "task_id": "task_1",
  "name": "普通周期任务",
  "execution_count": 4,
  "converted_to_interval": true,
  "end_time": "2025-09-14 22:30:14.709478"
}
2025-09-14 22:26:03 | SUCCESS  | __main__:dynamic_task_wrapper:218 | 动态任务执行完成
2025-09-14 22:26:03 | INFO     | __main__:_switch_to_interval_mode:304 | 任务已切换到间隔模式
2025-09-14 22:26:03 | INFO     | __main__:wrapped_task:393 | 开始执行任务
2025-09-14 22:26:03 | INFO     | __main__:sample_task:783 | 执行示例任务测试|5
2025-09-14 22:26:05 | SUCCESS  | __main__:wrapped_task:404 | 任务执行完成
2025-09-14 22:26:12 | INFO     | __main__:wrapped_task:393 | 开始执行任务
2025-09-14 22:26:12 | INFO     | __main__:error_task:796 | 执行会出错的任务
2025-09-14 22:26:12 | ERROR    | __main__:wrapped_task:431 | 任务执行失败
2025-09-14 22:26:13 | INFO     | __main__:dynamic_task_wrapper:205 | 执行动态任务
2025-09-14 22:26:13 | INFO     | __main__:data_processing_task:790 | 开始数据处理
2025-09-14 22:26:16 | SUCCESS  | __main__:dynamic_task_wrapper:218 | 动态任务执行完成
2025-09-14 22:26:17 | INFO     | __main__:wrapped_task:393 | 开始执行任务
2025-09-14 22:26:17 | INFO     | __main__:sample_task:783 | 执行示例任务测试|5
2025-09-14 22:26:19 | SUCCESS  | __main__:wrapped_task:404 | 任务执行完成
2025-09-14 22:26:22 | INFO     | __main__:<module>:885 | 动态任务状态: {
  "task_id": "dynamic_task_2",
  "name": "动态数据处理任务",
  "status": "running",
  "execution_count": 1,
  "start_time": "2025-09-14 22:26:00.730249"
}
2025-09-14 22:26:26 | INFO     | __main__:dynamic_task_wrapper:205 | 执行动态任务
2025-09-14 22:26:26 | INFO     | __main__:data_processing_task:790 | 开始数据处理
2025-09-14 22:26:29 | SUCCESS  | __main__:dynamic_task_wrapper:218 | 动态任务执行完成
2025-09-14 22:26:30 | INFO     | __main__:wrapped_task:393 | 开始执行任务
2025-09-14 22:26:30 | INFO     | __main__:sample_task:783 | 执行示例任务测试|5
2025-09-14 22:26:32 | SUCCESS  | __main__:wrapped_task:404 | 任务执行完成
2025-09-14 22:26:39 | INFO     | __main__:dynamic_task_wrapper:205 | 执行动态任务
2025-09-14 22:26:39 | INFO     | __main__:data_processing_task:790 | 开始数据处理
2025-09-14 22:26:42 | SUCCESS  | __main__:dynamic_task_wrapper:218 | 动态任务执行完成
2025-09-14 22:26:43 | INFO     | __main__:wrapped_task:393 | 开始执行任务
2025-09-14 22:26:43 | INFO     | __main__:sample_task:783 | 执行示例任务测试|5
2025-09-14 22:26:45 | SUCCESS  | __main__:wrapped_task:404 | 任务执行完成
2025-09-14 22:26:52 | INFO     | __main__:dynamic_task_wrapper:205 | 执行动态任务
2025-09-14 22:26:52 | INFO     | __main__:data_processing_task:790 | 开始数据处理
2025-09-14 22:26:55 | SUCCESS  | __main__:dynamic_task_wrapper:218 | 动态任务执行完成
2025-09-14 22:26:55 | INFO     | __main__:dynamic_task_wrapper:235 | 满足停止条件，任务即将停止
2025-09-14 22:26:55 | INFO     | __main__:_stop_dynamic_task:331 | 动态任务已停止
2025-09-14 22:26:56 | INFO     | __main__:wrapped_task:393 | 开始执行任务
2025-09-14 22:26:56 | INFO     | __main__:sample_task:783 | 执行示例任务测试|5
2025-09-14 22:26:58 | SUCCESS  | __main__:wrapped_task:404 | 任务执行完成
2025-09-14 22:26:59 | INFO     | __main__:wrapped_task:393 | 开始执行任务
2025-09-14 22:26:59 | INFO     | __main__:error_task:796 | 执行会出错的任务
2025-09-14 22:26:59 | ERROR    | __main__:wrapped_task:431 | 任务执行失败
2025-09-14 22:27:08 | INFO     | __main__:wrapped_task:393 | 开始执行任务
2025-09-14 22:27:08 | INFO     | __main__:sample_task:783 | 执行示例任务测试|5
2025-09-14 22:27:10 | SUCCESS  | __main__:wrapped_task:404 | 任务执行完成
2025-09-14 22:27:20 | INFO     | __main__:wrapped_task:393 | 开始执行任务
2025-09-14 22:27:20 | INFO     | __main__:sample_task:783 | 执行示例任务测试|5
2025-09-14 22:27:22 | INFO     | __main__:<module>:872 | 系统状态: {
  "is_running": true,
  "total_tasks": 3,
  "dynamic_tasks": 1,
  "normal_tasks": 2,
  "max_workers": 3,
  "scheduler_thread_alive": true,
  "pending_jobs": 2,
  "shutdown_requested": false
}
2025-09-14 22:27:22 | INFO     | __main__:<module>:873 | 任务统计: {
  "total_tasks": 3,
  "tasks_by_type": {
    "normal": 2,
    "dynamic_scheduled_to_interval": 1
  },
  "tasks_by_status": {
    "running": 2,
    "completed": 1
  },
  "tasks_by_unit": {
    "seconds": 2,
    "unknown": 1
  },
  "oldest_task": {
    "id": "task_1",
    "name": "普通周期任务",
    "created_at": "2025-09-14T22:24:42.698720"
  },
  "newest_task": {
    "id": "task_3",
    "name": "错误测试任务",
    "created_at": "2025-09-14T22:24:42.698720"
  },
  "total_executions": 19
}
2025-09-14 22:27:22 | INFO     | __main__:<module>:894 | 定时转间隔任务状态: {
  "task_id": "task_1",
  "name": "普通周期任务",
  "execution_count": 11,
  "converted_to_interval": true,
  "end_time": "2025-09-14 22:30:14.709478"
}
2025-09-14 22:27:22 | SUCCESS  | __main__:wrapped_task:404 | 任务执行完成
2025-09-14 22:27:32 | INFO     | __main__:wrapped_task:393 | 开始执行任务
2025-09-14 22:27:32 | INFO     | __main__:sample_task:783 | 执行示例任务测试|5
2025-09-14 22:27:34 | SUCCESS  | __main__:wrapped_task:404 | 任务执行完成
2025-09-14 22:27:42 | INFO     | __main__:<module>:885 | 动态任务状态: {
  "task_id": "dynamic_task_2",
  "name": "动态数据处理任务",
  "status": "completed",
  "execution_count": 5,
  "start_time": "2025-09-14 22:26:00.730249"
}
2025-09-14 22:27:44 | INFO     | __main__:wrapped_task:393 | 开始执行任务
2025-09-14 22:27:44 | INFO     | __main__:error_task:796 | 执行会出错的任务
2025-09-14 22:27:44 | ERROR    | __main__:wrapped_task:431 | 任务执行失败
2025-09-14 22:27:44 | INFO     | __main__:wrapped_task:393 | 开始执行任务
2025-09-14 22:27:44 | INFO     | __main__:sample_task:783 | 执行示例任务测试|5
2025-09-14 22:27:46 | SUCCESS  | __main__:wrapped_task:404 | 任务执行完成
2025-09-14 22:27:56 | INFO     | __main__:wrapped_task:393 | 开始执行任务
2025-09-14 22:27:56 | INFO     | __main__:sample_task:783 | 执行示例任务测试|5
2025-09-14 22:27:58 | SUCCESS  | __main__:wrapped_task:404 | 任务执行完成
2025-09-14 22:28:07 | WARNING  | __main__:_signal_handler:146 | 接收到信号 2，开始优雅关闭...
2025-09-14 22:28:07 | INFO     | __main__:shutdown:741 | 开始关闭高级任务管理器...
2025-09-14 22:28:07 | DEBUG    | __main__:shutdown:747 | 等待调度器线程结束...
