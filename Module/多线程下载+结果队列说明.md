# å¤šçº¿ç¨‹ä¸‹è½½ + ç»“æœé˜Ÿåˆ—æ–¹æ¡ˆ

## ğŸ¯ è®¾è®¡æ€æƒ³

**å¹¶è¡Œä¸‹è½½ + ä¸²è¡Œå¤„ç†**

### æ ¸å¿ƒç†å¿µ
1. **å¤šçº¿ç¨‹ä¸‹è½½**ï¼šå……åˆ†åˆ©ç”¨ç½‘ç»œå¸¦å®½ï¼Œæé«˜ä¸‹è½½é€Ÿåº¦
2. **ç»“æœé˜Ÿåˆ—**ï¼šä¸‹è½½å®Œæˆåæ”¾å…¥é˜Ÿåˆ—ï¼Œé¿å…ç›´æ¥æ“ä½œUI
3. **ä¸²è¡Œå¤„ç†**ï¼šä¸“é—¨çš„çº¿ç¨‹ä»é˜Ÿåˆ—ä¸­å–ç»“æœï¼Œä¾æ¬¡å¤„ç†

---

## ğŸ—ï¸ æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ä¸»çº¿ç¨‹ï¼ˆUIï¼‰                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ä¸‹è½½ç®¡ç†å™¨ (DownloadManager)                     â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚  â”‚
â”‚  â”‚  â”‚çº¿ç¨‹1   â”‚  â”‚çº¿ç¨‹2   â”‚  â”‚çº¿ç¨‹3   â”‚  ... å¤šçº¿ç¨‹ â”‚  â”‚
â”‚  â”‚  â”‚ä¸‹è½½A   â”‚  â”‚ä¸‹è½½B   â”‚  â”‚ä¸‹è½½C   â”‚             â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜             â”‚  â”‚
â”‚  â”‚      â”‚           â”‚           â”‚                   â”‚  â”‚
â”‚  â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚  â”‚
â”‚  â”‚                  â†“                                â”‚  â”‚
â”‚  â”‚          [ç»“æœé˜Ÿåˆ— Queue]                         â”‚  â”‚
â”‚  â”‚          â”‚ ç»“æœA â”‚ ç»“æœB â”‚ ç»“æœC â”‚                â”‚  â”‚
â”‚  â”‚                  â†“                                â”‚  â”‚
â”‚  â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚  â”‚
â”‚  â”‚        â”‚ ç»“æœå¤„ç†çº¿ç¨‹      â”‚ ä¸²è¡Œå¤„ç†             â”‚  â”‚
â”‚  â”‚        â”‚ ä»é˜Ÿåˆ—å–ç»“æœ      â”‚                      â”‚  â”‚
â”‚  â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚  â”‚
â”‚  â”‚                 â”‚ å‘é€ä¿¡å·                        â”‚  â”‚
â”‚  â”‚                 â†“                                 â”‚  â”‚
â”‚  â”‚         ä¸»çº¿ç¨‹å¤„ç†ï¼ˆåŠ è½½ã€æ˜¾ç¤ºï¼‰                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ æ ¸å¿ƒç»„ä»¶

### 1. `DownloadResult`ï¼ˆä¸‹è½½ç»“æœï¼‰

```python
class DownloadResult:
    def __init__(self, task_type: str, file_path: str, device_id: str, 
                 success: bool, error: str = ""):
        self.task_type = task_type    # 'excel' æˆ– 'image'
        self.file_path = file_path    # æ–‡ä»¶è·¯å¾„
        self.device_id = device_id    # è®¾å¤‡ID
        self.success = success        # æ˜¯å¦æˆåŠŸ
        self.error = error            # é”™è¯¯ä¿¡æ¯
```

### 2. `DownloadThread`ï¼ˆä¸‹è½½çº¿ç¨‹ï¼‰

```python
class DownloadThread(QThread):
    def __init__(self, task_type, client, file_id, save_path, device_id, result_queue):
        # ...
        self.result_queue = result_queue  # ç»“æœé˜Ÿåˆ—
    
    def run(self):
        # æ‰§è¡Œä¸‹è½½
        self.client.download_xxx_file(self.file_id, self.save_path)
        
        # âœ… ä¸‹è½½å®Œæˆï¼Œåˆ›å»ºç»“æœå¯¹è±¡
        result = DownloadResult(
            task_type=self.task_type,
            file_path=str(self.save_path),
            device_id=self.device_id,
            success=True
        )
        
        # âœ… æ”¾å…¥é˜Ÿåˆ—ï¼ˆä¸å‘é€ä¿¡å·ï¼‰
        self.result_queue.put(result)
```

### 3. `ResultProcessorThread`ï¼ˆç»“æœå¤„ç†çº¿ç¨‹ï¼‰

```python
class ResultProcessorThread(QThread):
    # ä¿¡å·
    result_ready = pyqtSignal(str, str, str)   # æˆåŠŸ
    result_failed = pyqtSignal(str, str, str)  # å¤±è´¥
    
    def run(self):
        while self.running:
            # âœ… ä»é˜Ÿåˆ—å–ç»“æœ
            result = self.result_queue.get(timeout=0.5)
            
            # âœ… é€šè¿‡ä¿¡å·å‘é€ç»™ä¸»çº¿ç¨‹
            if result.success:
                self.result_ready.emit(result.task_type, result.file_path, result.device_id)
            else:
                self.result_failed.emit(result.task_type, result.error, result.device_id)
```

### 4. `DownloadManager`ï¼ˆä¸‹è½½ç®¡ç†å™¨ï¼‰

```python
class DownloadManager:
    def __init__(self):
        self.result_queue = queue.Queue()  # å…±äº«ç»“æœé˜Ÿåˆ—
        self.active_threads = []           # æ´»è·ƒçš„ä¸‹è½½çº¿ç¨‹
        self.result_processor = ResultProcessorThread(self.result_queue)
        self.result_processor.start()
    
    def download(self, task_type, client, file_id, save_path, device_id):
        # åˆ›å»ºä¸‹è½½çº¿ç¨‹
        thread = DownloadThread(..., self.result_queue)
        self.active_threads.append(thread)
        thread.start()
```

---

## ğŸ”„ å·¥ä½œæµç¨‹

### åœºæ™¯ï¼š4ä¸ªæ–‡ä»¶åŒæ—¶ä¸‹è½½

```
1. æ”¶åˆ°4ä¸ªä¸‹è½½é€šçŸ¥
   â†“
2. åˆ›å»º4ä¸ªä¸‹è½½çº¿ç¨‹
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚çº¿ç¨‹1   â”‚  â”‚çº¿ç¨‹2   â”‚  â”‚çº¿ç¨‹3   â”‚  â”‚çº¿ç¨‹4   â”‚
   â”‚æ–‡ä»¶A   â”‚  â”‚æ–‡ä»¶B   â”‚  â”‚æ–‡ä»¶C   â”‚  â”‚æ–‡ä»¶D   â”‚
   â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
       â”‚  å¹¶è¡Œä¸‹è½½  â”‚           â”‚           â”‚
       â†“           â†“           â†“           â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚          ç»“æœé˜Ÿåˆ— (Queue)                   â”‚
   â”‚  [ç»“æœA] [ç»“æœB] [ç»“æœD] [ç»“æœC]            â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ æŒ‰å®Œæˆé¡ºåº
                  â†“
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚ ç»“æœå¤„ç†çº¿ç¨‹  â”‚ ä¸²è¡Œå¤„ç†
          â”‚ å–å‡º â†’ å‘ä¿¡å· â”‚
          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â†“
        ä¸»çº¿ç¨‹ä¾æ¬¡å¤„ç†
        A â†’ B â†’ D â†’ C
        â†“   â†“   â†“   â†“
      åŠ è½½  åŠ è½½ åŠ è½½ åŠ è½½
      æ˜¾ç¤º  æ˜¾ç¤º æ˜¾ç¤º æ˜¾ç¤º
```

---

## ğŸ†š å¯¹æ¯”ä¸‰ç§æ–¹æ¡ˆ

### æ–¹æ¡ˆ1ï¼šå¤šçº¿ç¨‹ç›´æ¥å‘ä¿¡å·ï¼ˆæ—§æ–¹æ¡ˆï¼‰

```python
# âŒ æ¯ä¸ªçº¿ç¨‹ç›´æ¥å‘ä¿¡å·ç»™ä¸»çº¿ç¨‹
class DownloadThread(QThread):
    download_finished = pyqtSignal(str, str)
    
    def run(self):
        download()
        self.download_finished.emit(file_path, device_id)  # å¤šä¸ªä¿¡å·åŒæ—¶åˆ°è¾¾

# é—®é¢˜ï¼š
# - å¤šä¸ªä¿¡å·å¯èƒ½åŒæ—¶åˆ°è¾¾ä¸»çº¿ç¨‹
# - å¹¶å‘å¤„ç†UIï¼Œå®¹æ˜“å‡ºç°ç«æ€
# - "4å¼ å›¾ç‰‡åœ¨åŒä¸€åŒºåŸŸ"å°±æ˜¯è¿™ä¸ªåŸå› 
```

### æ–¹æ¡ˆ2ï¼šå•çº¿ç¨‹ + ä»»åŠ¡é˜Ÿåˆ—

```python
# âœ… åªæœ‰1ä¸ªå·¥ä½œçº¿ç¨‹ï¼Œä»»åŠ¡æ’é˜Ÿ
class DownloadWorkerThread(QThread):
    def run(self):
        while True:
            task = task_queue.get()  # ä¸²è¡Œå–ä»»åŠ¡
            download(task)           # ä¸²è¡Œä¸‹è½½
            emit_signal()            # ä¸²è¡Œå‘ä¿¡å·

# ä¼˜ç‚¹ï¼š
# - ä¸²è¡Œä¸‹è½½ï¼Œç»å¯¹ä¸ä¼šç«äº‰
# - é€»è¾‘ç®€å•

# ç¼ºç‚¹ï¼š
# - ä¸‹è½½é€Ÿåº¦æ…¢ï¼ˆåªæœ‰1ä¸ªçº¿ç¨‹ï¼‰
# - æ— æ³•å……åˆ†åˆ©ç”¨ç½‘ç»œå¸¦å®½
```

### æ–¹æ¡ˆ3ï¼šå¤šçº¿ç¨‹ + ç»“æœé˜Ÿåˆ—ï¼ˆâœ… å½“å‰æ–¹æ¡ˆï¼‰

```python
# âœ… å¤šä¸ªä¸‹è½½çº¿ç¨‹ + ç»“æœé˜Ÿåˆ— + ä¸²è¡Œå¤„ç†
class DownloadThread(QThread):
    def run(self):
        download()                        # å¹¶è¡Œä¸‹è½½
        result_queue.put(result)          # ç»“æœæ”¾å…¥é˜Ÿåˆ—

class ResultProcessor(QThread):
    def run(self):
        while True:
            result = result_queue.get()   # ä¸²è¡Œå–ç»“æœ
            emit_signal(result)           # ä¸²è¡Œå‘ä¿¡å·

# ä¼˜ç‚¹ï¼š
# - ä¸‹è½½é€Ÿåº¦å¿«ï¼ˆå¤šçº¿ç¨‹å¹¶è¡Œï¼‰
# - å¤„ç†ä¸²è¡Œï¼ˆé¿å…UIç«äº‰ï¼‰
# - å……åˆ†åˆ©ç”¨ç½‘ç»œå¸¦å®½
# - æ—¢å¿«åˆå®‰å…¨ï¼
```

---

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

| æ–¹æ¡ˆ | ä¸‹è½½é€Ÿåº¦ | UIå®‰å…¨æ€§ | èµ„æºå ç”¨ | å¤æ‚åº¦ |
|------|---------|---------|---------|--------|
| æ–¹æ¡ˆ1ï¼ˆå¤šçº¿ç¨‹ç›´æ¥ï¼‰ | â­â­â­â­â­ | â­ | é«˜ | ä½ |
| æ–¹æ¡ˆ2ï¼ˆå•çº¿ç¨‹é˜Ÿåˆ—ï¼‰ | â­â­ | â­â­â­â­â­ | ä½ | ä½ |
| æ–¹æ¡ˆ3ï¼ˆå¤šçº¿ç¨‹+é˜Ÿåˆ—ï¼‰| â­â­â­â­â­ | â­â­â­â­â­ | ä¸­ | ä¸­ |

**ç»“è®ºï¼šæ–¹æ¡ˆ3æœ€ä¼˜ï¼**

---

## ğŸ”§ ä½¿ç”¨æ–¹å¼

### åˆå§‹åŒ–

```python
# åœ¨çª—å£ __init__ ä¸­
self.download_manager = DownloadManager()

# è¿æ¥ä¿¡å·
self.download_manager.result_processor.result_ready.connect(self.on_download_finished)
self.download_manager.result_processor.result_failed.connect(self.on_download_failed)
```

### å¯åŠ¨ä¸‹è½½

```python
# æ”¶åˆ°ä¸‹è½½é€šçŸ¥
def on_new_data_received(self, data):
    file_id = data.get('file_id')
    device_id = data.get('device_id')
    
    # å¯åŠ¨ä¸‹è½½çº¿ç¨‹ï¼ˆå¤šçº¿ç¨‹å¹¶è¡Œï¼‰
    self.download_manager.download(
        task_type='excel',      # æˆ– 'image'
        client=self.client,
        file_id=file_id,
        save_path=save_path,
        device_id=device_id
    )
    # ç«‹å³è¿”å›ï¼Œä¸é˜»å¡
```

### å¤„ç†ç»“æœ

```python
# ç»“æœå¤„ç†ï¼ˆä¸²è¡Œï¼Œä¸€ä¸ªä¸€ä¸ªæ¥ï¼‰
def on_download_finished(self, task_type: str, file_path: str, device_id: str):
    if task_type == 'excel':
        self.load_excel_file(file_path, device_id)
    elif task_type == 'image':
        self.load_image_file(file_path, device_id)
```

---

## ğŸ¯ å…³é”®ä¼˜åŠ¿

### 1. **å¿«é€Ÿä¸‹è½½**
```
4ä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ª1MBï¼Œå¸¦å®½10MB/s

æ–¹æ¡ˆ2ï¼ˆå•çº¿ç¨‹ï¼‰:
  ä¸‹è½½1 â†’ ä¸‹è½½2 â†’ ä¸‹è½½3 â†’ ä¸‹è½½4
  1s + 1s + 1s + 1s = 4ç§’

æ–¹æ¡ˆ3ï¼ˆå¤šçº¿ç¨‹ï¼‰:
  ä¸‹è½½1 â”
  ä¸‹è½½2 â”œâ”€ å¹¶è¡Œä¸‹è½½
  ä¸‹è½½3 â”‚
  ä¸‹è½½4 â”˜
  çº¦1ç§’å®Œæˆï¼
```

### 2. **ä¸²è¡Œå¤„ç†**
```
ä¸‹è½½é¡ºåº: A â† B â† D â† C (æŒ‰å®Œæˆæ—¶é—´)
å¤„ç†é¡ºåº: A â†’ B â†’ D â†’ C (FIFOé˜Ÿåˆ—)

æ¯æ¬¡åªå¤„ç†1ä¸ªç»“æœï¼Œä¸ä¼šå†²çª âœ…
```

### 3. **çº¿ç¨‹å®‰å…¨**
- ä¸‹è½½çº¿ç¨‹åªè´Ÿè´£ä¸‹è½½ï¼Œä¸æ“ä½œUI
- ç»“æœçº¿ç¨‹åªè´Ÿè´£å‘ä¿¡å·ï¼Œä¸æ“ä½œUI
- ä¸»çº¿ç¨‹æ”¶åˆ°ä¿¡å·åæ‰æ“ä½œUI
- å®Œå…¨éš”ç¦»ï¼Œç»å¯¹å®‰å…¨ âœ…

### 4. **èµ„æºç®¡ç†**
- è‡ªåŠ¨æ¸…ç†å®Œæˆçš„çº¿ç¨‹
- æ´»è·ƒçº¿ç¨‹åˆ—è¡¨å¯æŸ¥è¯¢
- æ”¯æŒåœæ­¢æ‰€æœ‰ä¸‹è½½

---

## ğŸ“ æ—¥å¿—ç¤ºä¾‹

### å¯åŠ¨ä¸‹è½½

```
2025-12-12 05:30:01 | INFO | åˆ›å»ºä¸‹è½½çº¿ç¨‹: image, img_001.png, æ´»è·ƒçº¿ç¨‹æ•°: 1
2025-12-12 05:30:01 | INFO | åˆ›å»ºä¸‹è½½çº¿ç¨‹: image, img_002.png, æ´»è·ƒçº¿ç¨‹æ•°: 2
2025-12-12 05:30:01 | INFO | åˆ›å»ºä¸‹è½½çº¿ç¨‹: image, img_003.png, æ´»è·ƒçº¿ç¨‹æ•°: 3
2025-12-12 05:30:01 | INFO | åˆ›å»ºä¸‹è½½çº¿ç¨‹: image, img_004.png, æ´»è·ƒçº¿ç¨‹æ•°: 4
```

### å¹¶è¡Œä¸‹è½½

```
2025-12-12 05:30:01 | INFO | [ä¸‹è½½çº¿ç¨‹] å¼€å§‹ä¸‹è½½ image: img_001.png
2025-12-12 05:30:01 | INFO | [ä¸‹è½½çº¿ç¨‹] å¼€å§‹ä¸‹è½½ image: img_002.png
2025-12-12 05:30:01 | INFO | [ä¸‹è½½çº¿ç¨‹] å¼€å§‹ä¸‹è½½ image: img_003.png
2025-12-12 05:30:01 | INFO | [ä¸‹è½½çº¿ç¨‹] å¼€å§‹ä¸‹è½½ image: img_004.png
```

### ç»“æœå…¥é˜Ÿ

```
2025-12-12 05:30:02 | INFO | [ä¸‹è½½çº¿ç¨‹] ä¸‹è½½å®Œæˆ image: img_002.png
2025-12-12 05:30:02 | DEBUG| [ä¸‹è½½çº¿ç¨‹] ç»“æœå·²æ”¾å…¥é˜Ÿåˆ—ï¼Œé˜Ÿåˆ—å¤§å°: 1
2025-12-12 05:30:02 | INFO | [ä¸‹è½½çº¿ç¨‹] ä¸‹è½½å®Œæˆ image: img_001.png
2025-12-12 05:30:02 | DEBUG| [ä¸‹è½½çº¿ç¨‹] ç»“æœå·²æ”¾å…¥é˜Ÿåˆ—ï¼Œé˜Ÿåˆ—å¤§å°: 2
```

### ä¸²è¡Œå¤„ç†

```
2025-12-12 05:30:02 | INFO | [ç»“æœå¤„ç†çº¿ç¨‹] å¤„ç†æˆåŠŸç»“æœ: image, img_002.png
2025-12-12 05:30:02 | INFO | [è®¾å¤‡12323] âœ… å›¾ç‰‡å·²åŠ è½½åˆ°åŒºåŸŸ 0: img_002.png
2025-12-12 05:30:02 | INFO | [ç»“æœå¤„ç†çº¿ç¨‹] å¤„ç†æˆåŠŸç»“æœ: image, img_001.png
2025-12-12 05:30:02 | INFO | [è®¾å¤‡12323] âœ… å›¾ç‰‡å·²åŠ è½½åˆ°åŒºåŸŸ 1: img_001.png
```

---

## âœ… æ€»ç»“

### æ ¸å¿ƒç‰¹æ€§

1. **å¤šçº¿ç¨‹ä¸‹è½½**ï¼š4ä¸ªæ–‡ä»¶åŒæ—¶ä¸‹è½½ï¼Œå……åˆ†åˆ©ç”¨å¸¦å®½
2. **ç»“æœé˜Ÿåˆ—**ï¼šä¸‹è½½å®Œæˆåæ”¾å…¥é˜Ÿåˆ—ï¼Œä¸ç›´æ¥æ“ä½œUI
3. **ä¸²è¡Œå¤„ç†**ï¼šä¸“é—¨çš„çº¿ç¨‹ä»é˜Ÿåˆ—å–ç»“æœï¼Œä¾æ¬¡å¤„ç†
4. **çº¿ç¨‹å®‰å…¨**ï¼šä¸‹è½½å’Œå¤„ç†å®Œå…¨éš”ç¦»ï¼Œé¿å…ç«æ€

### æ–‡ä»¶æ¸…å•

- `Module/common/download_manager.py` - ä¸‹è½½ç®¡ç†å™¨
- `Module/excel_data_viewer/index/excel_viewer_window.py` - ç”µé‡ç•Œé¢ï¼ˆå·²ä¿®æ”¹ï¼‰
- `Module/image_data_viewer/index/image_viewer_window.py` - å‡ ä½•é‡ç•Œé¢ï¼ˆå·²ä¿®æ”¹ï¼‰

### å…³é”®ä»£ç 

```python
# åˆå§‹åŒ–
self.download_manager = DownloadManager()
self.download_manager.result_processor.result_ready.connect(self.on_result)

# å¯åŠ¨ä¸‹è½½ï¼ˆå¤šçº¿ç¨‹å¹¶è¡Œï¼‰
self.download_manager.download('image', client, file_id, save_path, device_id)

# å¤„ç†ç»“æœï¼ˆä¸²è¡Œï¼Œé¿å…å†²çªï¼‰
def on_result(self, task_type, file_path, device_id):
    self.load_and_display(file_path, device_id)
```

**å¿«é€Ÿ + å®‰å…¨ = å®Œç¾ï¼** ğŸ‰

