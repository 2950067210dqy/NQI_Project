# ç•Œé¢æ”¹è¿›è¯´æ˜

**æ›´æ–°æ—¥æœŸ**: 2025-12-12

---

## âœ… å®Œæˆçš„æ”¹è¿›

### 1. ç”µé‡æ•°æ®é¡µé¢ - æ·»åŠ æ–‡ä»¶åæ˜¾ç¤º

**ä½ç½®**: è®¾å¤‡ä¿¡æ¯ç»„ï¼ˆæ¯ä¸ªè®¾å¤‡é€‰é¡¹å¡çš„é¡¶éƒ¨ï¼‰

**æ”¹è¿›å‰**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è®¾å¤‡ä¿¡æ¯         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è®¾å¤‡ID: 12323    â”‚
â”‚ æ—¶é—´: 14:30:00   â”‚
â”‚ é¢å®šç”µå‹: 220V   â”‚
â”‚ é¢å®šé¢‘ç‡: 50Hz   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ”¹è¿›å**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è®¾å¤‡ä¿¡æ¯                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è®¾å¤‡ID: 12323                           â”‚
â”‚ æ–‡ä»¶å: 20251212_143000_TA3310ä¸‰ç›¸è¡¨æ•°æ®.xlsx â”‚ â† æ–°å¢
â”‚        (è“è‰²åŠ ç²—æ˜¾ç¤º)                    â”‚
â”‚ æ—¶é—´: 14:30:00                          â”‚
â”‚ é¢å®šç”µå‹: 220V                          â”‚
â”‚ é¢å®šé¢‘ç‡: 50Hz                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å®ç°**:
- åœ¨ `create_device_tab_content()` æ–¹æ³•ä¸­æ·»åŠ æ–‡ä»¶åå‚æ•°
- æ–‡ä»¶åç”¨è“è‰²åŠ ç²—å­—ä½“æ˜¾ç¤º
- è‡ªåŠ¨ä»æ–‡ä»¶è·¯å¾„æå–æ–‡ä»¶å

**ä»£ç **:
```python
# æ˜¾ç¤ºæ–‡ä»¶å
if file_name:
    file_label = QLabel(f"æ–‡ä»¶å: {file_name}")
    file_label.setStyleSheet("color: #0066cc; font-weight: bold;")
    info_layout.addWidget(file_label)
```

---

### 2. å‡ ä½•é‡æ•°æ®é¡µé¢ - æœ€æ–°å›¾ç‰‡æ˜¾ç¤ºåœ¨å‰

**ä½ç½®**: å®æ—¶è¯†åˆ«é€‰é¡¹å¡çš„å›¾ç‰‡ç½‘æ ¼

**æ”¹è¿›å‰**ï¼ˆFIFOï¼Œæœ€æ–°åœ¨åï¼‰:
```
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ æ—§1 â”‚ æ—§2 â”‚ æ—§3 â”‚ æ—§4 â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
â”‚ æ—§5 â”‚ æ—§6 â”‚ æ—§7 â”‚æ–°8 â”‚ â† æ–°å›¾ç‰‡åœ¨æœ€å
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
```

**æ”¹è¿›å**ï¼ˆLIFOï¼Œæœ€æ–°åœ¨å‰ï¼‰:
```
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ æ–°8 â”‚ æ–°7 â”‚ æ–°6 â”‚ æ–°5 â”‚ â† æ–°å›¾ç‰‡åœ¨ç¬¬ä¸€ä¸ª
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
â”‚ æ—§4 â”‚ æ—§3 â”‚ æ—§2 â”‚ æ—§1 â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
```

**å·¥ä½œåŸç†**:
1. æ–°å›¾ç‰‡åˆ°è¾¾æ—¶ï¼Œæ’å…¥åˆ°ç¬¬0ä½ï¼ˆå·¦ä¸Šè§’ï¼‰
2. æ‰€æœ‰æ—§å›¾ç‰‡å‘åç§»åŠ¨ä¸€ä½
3. è¾¾åˆ°æœ€å¤§æ•°é‡ï¼ˆ20ä¸ªï¼‰æ—¶ï¼Œåˆ é™¤æœ€åä¸€ä¸ª

**å®ç°**:
```python
def get_next_widget_for_device(self, device_tab):
    # å¦‚æœè¾¾åˆ°æœ€å¤§æ•°é‡ï¼Œåˆ é™¤æœ€åä¸€ä¸ª
    if current_count >= self.max_widget_count:
        last_widget = image_widgets.pop()
        grid_layout.removeWidget(last_widget)
        last_widget.deleteLater()
    
    # åˆ›å»ºæ–°åŒºåŸŸ
    new_widget = ImageDisplayWidget(0)
    
    # æ‰€æœ‰ç°æœ‰åŒºåŸŸå‘åç§»åŠ¨
    for i in range(len(image_widgets) - 1, -1, -1):
        old_widget = image_widgets[i]
        old_widget.index = i + 1  # æ›´æ–°ç´¢å¼•
        # ç§»åŠ¨åˆ°æ–°ä½ç½®
        new_row = (i + 1) // 2
        new_col = (i + 1) % 2
        grid_layout.addWidget(old_widget, new_row, new_col)
    
    # æ’å…¥æ–°åŒºåŸŸåˆ°ç¬¬0ä½
    image_widgets.insert(0, new_widget)
    grid_layout.addWidget(new_widget, 0, 0)
    
    return new_widget  # è¿”å›ç¬¬0ä¸ªåŒºåŸŸ
```

**ä¼˜åŠ¿**:
- âœ… æœ€æ–°å›¾ç‰‡æœ€æ˜¾çœ¼ï¼ˆå·¦ä¸Šè§’ï¼‰
- âœ… ç¬¦åˆç”¨æˆ·æŸ¥çœ‹ä¹ æƒ¯
- âœ… æ— éœ€æ»šåŠ¨å°±èƒ½çœ‹åˆ°æ–°æ•°æ®

---

## ğŸ¨ ç•Œé¢æ•ˆæœ

### ç”µé‡æ•°æ®é¡µé¢

**è®¾å¤‡é€‰é¡¹å¡**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è®¾å¤‡ 12323                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ è®¾å¤‡ä¿¡æ¯                                  â”‚  â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚ â”‚ è®¾å¤‡ID: 12323                            â”‚  â”‚
â”‚ â”‚ æ–‡ä»¶å: 20251212_143000_TA3310ä¸‰ç›¸è¡¨æ•°æ®.xlsx â”‚ â† è“è‰²åŠ ç²—
â”‚ â”‚ æ—¶é—´: 2025-12-12 14:30:00                â”‚  â”‚
â”‚ â”‚ é¢å®šç”µå‹: 220V                           â”‚  â”‚
â”‚ â”‚ é¢å®šé¢‘ç‡: 50Hz                           â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ [åŠŸç‡W] [ç”µå‹] [ç”µæµ] [ç›¸è§’]             â”‚  â”‚
â”‚ â”‚                                          â”‚  â”‚
â”‚ â”‚   (æ•°æ®å›¾è¡¨)                             â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å‡ ä½•é‡æ•°æ®é¡µé¢

**å›¾ç‰‡æ˜¾ç¤ºé¡ºåº**ï¼ˆ2åˆ—4è¡Œï¼Œå…±8ä¸ªï¼Œæœ€å¤š20ä¸ªï¼‰:
```
æ¥æ”¶é¡ºåº: img1 â†’ img2 â†’ img3 â†’ img4 â†’ img5

æ˜¾ç¤ºä½ç½®:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ img5  â”‚ img4  â”‚ â† ç¬¬ä¸€è¡Œï¼šæœ€æ–°çš„ä¸¤å¼ 
â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ img3  â”‚ img2  â”‚ â† ç¬¬äºŒè¡Œ
â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ img1  â”‚       â”‚ â† ç¬¬ä¸‰è¡Œï¼šæœ€æ—§çš„
â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚       â”‚       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ–°å›¾ç‰‡åˆ°è¾¾å**ï¼ˆimg6ï¼‰:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ img6  â”‚ img5  â”‚ â† img6æ’å…¥åˆ°ç¬¬0ä½ï¼Œå…¶ä»–åç§»
â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ img4  â”‚ img3  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ img2  â”‚ img1  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚       â”‚       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### 1. æ–‡ä»¶åä¼ é€’

**è°ƒç”¨é“¾**:
```
on_cache_data_ready(file_path, device_id)
    â†“
file_name = Path(file_path).name
    â†“
create_or_update_device_tab(device_id, sheet_data_dict, file_name)
    â†“
create_device_tab_content(device_id, sheet_data_dict, file_name)
    â†“
æ˜¾ç¤ºåœ¨è®¾å¤‡ä¿¡æ¯ä¸­
```

### 2. å›¾ç‰‡é¡ºåºç®¡ç†

**æ’å…¥é€»è¾‘**:
```python
# 1. åˆ é™¤æœ€åä¸€ä¸ªï¼ˆå¦‚æœæ»¡äº†ï¼‰
if len(widgets) >= max_count:
    last = widgets.pop()
    last.deleteLater()

# 2. åˆ›å»ºæ–°åŒºåŸŸ
new_widget = ImageDisplayWidget(0)

# 3. æ—§åŒºåŸŸåç§»
for i in range(len(widgets) - 1, -1, -1):
    widget[i].index = i + 1
    grid_layout.addWidget(widget[i], (i+1)//2, (i+1)%2)

# 4. æ’å…¥æ–°åŒºåŸŸåˆ°ç¬¬0ä½
widgets.insert(0, new_widget)
grid_layout.addWidget(new_widget, 0, 0)
```

**ç½‘æ ¼ä½ç½®è®¡ç®—**:
```python
# 2åˆ—å¸ƒå±€
row = index // 2  # è¡Œå· = ç´¢å¼• Ã· 2
col = index % 2   # åˆ—å· = ç´¢å¼• % 2

# ç¤ºä¾‹:
# index 0 â†’ row=0, col=0 (ç¬¬1è¡Œç¬¬1åˆ—)
# index 1 â†’ row=0, col=1 (ç¬¬1è¡Œç¬¬2åˆ—)
# index 2 â†’ row=1, col=0 (ç¬¬2è¡Œç¬¬1åˆ—)
# index 3 â†’ row=1, col=1 (ç¬¬2è¡Œç¬¬2åˆ—)
```

---

## ğŸ“Š ç”¨æˆ·ä½“éªŒæå‡

### ç”µé‡æ•°æ®é¡µé¢

**æ”¹è¿›å‰**:
- ä¸çŸ¥é“å½“å‰æ˜¾ç¤ºçš„æ˜¯å“ªä¸ªæ–‡ä»¶
- éœ€è¦æŸ¥çœ‹å†å²è®°å½•æ‰èƒ½ç¡®è®¤

**æ”¹è¿›å**:
- âœ… ä¸€çœ¼çœ‹åˆ°æ–‡ä»¶å
- âœ… è“è‰²åŠ ç²—ï¼Œé†’ç›®
- âœ… å¿«é€Ÿè¯†åˆ«æ•°æ®æ¥æº

### å‡ ä½•é‡æ•°æ®é¡µé¢

**æ”¹è¿›å‰**:
- æœ€æ–°å›¾ç‰‡åœ¨æœ€åï¼Œéœ€è¦æ»šåŠ¨æŸ¥çœ‹
- ä¸ç¬¦åˆæŸ¥çœ‹ä¹ æƒ¯

**æ”¹è¿›å**:
- âœ… æœ€æ–°å›¾ç‰‡åœ¨å·¦ä¸Šè§’ç¬¬ä¸€ä¸ªä½ç½®
- âœ… æ— éœ€æ»šåŠ¨ï¼Œç«‹å³çœ‹åˆ°
- âœ… ç¬¦åˆä»ä¸Šåˆ°ä¸‹ã€ä»å·¦åˆ°å³çš„æŸ¥çœ‹ä¹ æƒ¯

---

## âœ… éªŒè¯æ¸…å•

- [x] ç”µé‡é¡µé¢è®¾å¤‡ä¿¡æ¯æ˜¾ç¤ºæ–‡ä»¶å
- [x] æ–‡ä»¶åç”¨è“è‰²åŠ ç²—å­—ä½“
- [x] å‡ ä½•é‡é¡µé¢æ–°å›¾ç‰‡åœ¨ç¬¬0ä½
- [x] æ—§å›¾ç‰‡è‡ªåŠ¨åç§»
- [x] è¾¾åˆ°æœ€å¤§æ•°é‡æ—¶åˆ é™¤æœ€åä¸€ä¸ª
- [x] æ‰€æœ‰æ–‡ä»¶æ— Linteré”™è¯¯

---

## ğŸ¯ æ•ˆæœé¢„è§ˆ

### æ¥æ”¶å›¾ç‰‡é¡ºåºæ¼”ç¤º

**ç¬¬1å¼ å›¾ç‰‡åˆ°è¾¾**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ img1  â”‚       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç¬¬2å¼ å›¾ç‰‡åˆ°è¾¾**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ img2  â”‚ img1  â”‚ â† img2åœ¨ç¬¬0ä½ï¼Œimg1åç§»
â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç¬¬3å¼ å›¾ç‰‡åˆ°è¾¾**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ img3  â”‚ img2  â”‚ â† img3åœ¨ç¬¬0ä½
â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ img1  â”‚       â”‚ â† img1ç»§ç»­åç§»
â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç¬¬20å¼ å›¾ç‰‡åˆ°è¾¾**ï¼ˆæ»¡äº†ï¼‰:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ img20 â”‚ img19 â”‚ â† æœ€æ–°çš„ä¸¤å¼ 
â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ img18 â”‚ img17 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ...  â”‚  ...  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ img2  â”‚ img1  â”‚ â† æœ€æ—§çš„ä¸¤å¼ ï¼ˆç¬¬10è¡Œï¼‰
â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç¬¬21å¼ å›¾ç‰‡åˆ°è¾¾**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ img21 â”‚ img20 â”‚ â† img21åœ¨ç¬¬0ä½
â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ img19 â”‚ img18 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ...  â”‚  ...  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ img3  â”‚ img2  â”‚ â† img1è¢«åˆ é™¤
â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**æ›´æ–°æ—¥æœŸ**: 2025-12-12  
**æ”¹è¿›é¡¹**: 2é¡¹  
**çŠ¶æ€**: âœ… å·²å®Œæˆ

